# SQLite. Versions 3.8.0 and up are supported.
# With Rails 8 and proper configuration, SQLite is production-ready.

default: &default
  adapter: sqlite3
  pool: <%= ENV.fetch("RAILS_MAX_THREADS") { 5 } %>
  timeout: 5000

development:
  <<: *default
  database: storage/development.sqlite3

# Warning: The database defined as "test" will be erased and
# re-generated from your development database when you run "rake".
# Do not set this db to the same as development or production.
# 
# IMPORTANT: Tests should be run in isolated test container with separate storage volume.
# Use: docker compose run --rm test bundle exec rails test
test:
  <<: *default
  database: storage/test.sqlite3
  # Additional safety: Prevent schema copy from development
  # Tests will use db/schema.rb instead of copying from development database
  prepared_statements: false

# Docker environment (for local development with Docker)
docker:
  <<: *default
  database: storage/docker.sqlite3

# AWS Test environment (SQLite with persistent storage)
aws_test:
  <<: *default
  database: storage/aws_test.sqlite3

# AWS Production environment (SQLite with persistent storage)
production:
  <<: *default
  database: storage/production.sqlite3
