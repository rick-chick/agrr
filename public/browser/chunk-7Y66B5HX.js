import{a as b}from"./chunk-DRVNX7Y7.js";import{a as E}from"./chunk-IUKFKDHB.js";import"./chunk-S2ZNJ6LP.js";import"./chunk-TVVNGJEJ.js";import{e as y}from"./chunk-FUJATOUC.js";import"./chunk-TEDWIW3V.js";import"./chunk-ZHQLFSMJ.js";import{g as S,j as h}from"./chunk-NXFG3DMW.js";import{$ as f,Aa as a,Fb as L,Ma as d,Ra as u,U as l,Xa as _,Ya as g,_ as p,ab as c,bb as r,cb as i,hb as C,lb as x,nb as m,vb as o,wb as F,xb as v}from"./chunk-OVGF36KA.js";var I=t=>["/farms",t];function T(t,n){t&1&&(r(0,"p",2),o(1,"Loading..."),i())}function D(t,n){if(t&1&&(r(0,"p",3),o(1),i()),t&2){let e=m();a(),v("Error: ",e.error)}}function M(t,n){if(t&1){let e=C();r(0,"li")(1,"a",5),o(2),i(),r(3,"button",6),x("click",function(){let k=p(e).$implicit,w=m(2);return f(w.deleteFarm(k.id))}),o(4,"Delete"),i()()}if(t&2){let e=n.$implicit;a(),c("routerLink",L(2,I,e.id)),a(),F(e.name)}}function N(t,n){if(t&1&&(r(0,"ul"),u(1,M,5,4,"li",4),i()),t&2){let e=m();a(),c("ngForOf",e.farms)}}var O=class t{farms=[];loading=!0;error=null;farmService=l(E);authService=l(b);ngOnInit(){console.log("FarmListComponent: ngOnInit"),this.authService.ensureApiKey(this.farmService.list()).subscribe({next:n=>{console.log("FarmListComponent: Success",JSON.stringify(n)),this.farms=n,this.loading=!1,console.log("FarmListComponent: loading set to false")},error:n=>{console.error("FarmListComponent: Error",JSON.stringify(n)),this.error=n?.message||"Unknown error",this.loading=!1}})}deleteFarm(n){confirm("Delete this farm?")&&this.farmService.destroy(n).subscribe({next:()=>{this.farms=this.farms.filter(e=>e.id!==n)},error:e=>{this.error=e.message}})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=d({type:t,selectors:[["app-farm-list"]],decls:8,vars:1,consts:[[1,"page"],["routerLink","/farms/new"],[1,"loading"],[1,"error"],[4,"ngFor","ngForOf"],[3,"routerLink"],["type","button",3,"click"]],template:function(e,s){e&1&&(r(0,"section",0)(1,"h2"),o(2,"Farms"),i(),r(3,"a",1),o(4,"Create Farm"),i(),_(5,T,2,0,"p",2)(6,D,2,1,"p",3)(7,N,2,1,"ul"),i()),e&2&&(a(5),g(s.loading?5:s.error?6:7))},dependencies:[h,S,y],styles:[".page[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:12px;border:1px solid #e3e5e8}.error[_ngcontent-%COMP%]{color:#dc2626}"]})};export{O as FarmListComponent};
