import{a as V,b as W,c as N,d as L,e as R,f as T,g as P,h as q,i as A}from"./chunk-T4Z6357I.js";import{a as I}from"./chunk-IUKFKDHB.js";import"./chunk-S2ZNJ6LP.js";import"./chunk-TVVNGJEJ.js";import{b as E,d as b,e as D}from"./chunk-FUJATOUC.js";import"./chunk-TEDWIW3V.js";import"./chunk-ZHQLFSMJ.js";import{j as w}from"./chunk-NXFG3DMW.js";import{$ as g,Aa as d,Ab as p,Bb as c,Cb as f,Ia as _,Ma as C,Xa as h,Ya as x,_ as u,ab as S,bb as n,cb as a,hb as v,lb as y,nb as s,rb as F,vb as l,wb as M}from"./chunk-OVGF36KA.js";function j(m,t){m&1&&(n(0,"p"),l(1,"Loading..."),a())}function k(m,t){if(m&1&&(n(0,"p",3),l(1),a()),m&2){let i=s();d(),M(i.error)}}function O(m,t){if(m&1){let i=v();n(0,"form",4,0),y("ngSubmit",function(){u(i);let e=s();return g(e.updateFarm())}),n(2,"label"),l(3," Name "),n(4,"input",5),f("ngModelChange",function(e){u(i);let o=s();return c(o.formData.name,e)||(o.formData.name=e),g(e)}),a()(),n(5,"label"),l(6," Region "),n(7,"input",6),f("ngModelChange",function(e){u(i);let o=s();return c(o.formData.region,e)||(o.formData.region=e),g(e)}),a()(),n(8,"label"),l(9," Latitude "),n(10,"input",7),f("ngModelChange",function(e){u(i);let o=s();return c(o.formData.latitude,e)||(o.formData.latitude=e),g(e)}),a()(),n(11,"label"),l(12," Longitude "),n(13,"input",8),f("ngModelChange",function(e){u(i);let o=s();return c(o.formData.longitude,e)||(o.formData.longitude=e),g(e)}),a()(),n(14,"button",9),l(15,"Save"),a()()}if(m&2){let i=F(1),r=s();d(4),p("ngModel",r.formData.name),d(3),p("ngModel",r.formData.region),d(3),p("ngModel",r.formData.latitude),d(3),p("ngModel",r.formData.longitude),d(),S("disabled",i.invalid||r.saving)}}var B=class m{constructor(t,i,r){this.route=t;this.farmService=i;this.router=r}loading=!0;saving=!1;error=null;formData={name:"",region:"",latitude:0,longitude:0};farmId=0;ngOnInit(){if(this.farmId=Number(this.route.snapshot.paramMap.get("id")),!this.farmId){this.error="Invalid farm id.",this.loading=!1;return}this.farmService.show(this.farmId).subscribe({next:t=>{this.formData={name:t.name,region:t.region,latitude:t.latitude,longitude:t.longitude},this.loading=!1},error:t=>{this.error=t.message,this.loading=!1}})}updateFarm(){this.saving||(this.saving=!0,this.error=null,this.farmService.update(this.farmId,this.formData).subscribe({next:()=>{this.router.navigate(["/farms",this.farmId])},error:t=>{this.error=t.error?.errors?.join(", ")??t.message??"Failed to update farm.",this.saving=!1}}))}static \u0275fac=function(i){return new(i||m)(_(E),_(I),_(b))};static \u0275cmp=C({type:m,selectors:[["app-farm-edit"]],decls:8,vars:1,consts:[["farmForm","ngForm"],[1,"page"],["routerLink","/farms"],[1,"error"],[3,"ngSubmit"],["name","name","required","",3,"ngModelChange","ngModel"],["name","region","required","",3,"ngModelChange","ngModel"],["name","latitude","type","number","step","0.000001","required","",3,"ngModelChange","ngModel"],["name","longitude","type","number","step","0.000001","required","",3,"ngModelChange","ngModel"],["type","submit",3,"disabled"]],template:function(i,r){i&1&&(n(0,"section",1)(1,"a",2),l(2,"Back to farms"),a(),n(3,"h2"),l(4,"Edit Farm"),a(),h(5,j,2,0,"p")(6,k,2,1,"p",3)(7,O,16,5,"form"),a()),i&2&&(d(5),x(r.loading?5:r.error?6:7))},dependencies:[w,A,T,V,P,W,N,q,R,L,D],encapsulation:2})};export{B as FarmEditComponent};
