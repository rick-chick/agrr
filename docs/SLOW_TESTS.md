# ğŸŒ é…ã„Systemãƒ†ã‚¹ãƒˆä¸€è¦§

æœ€çµ‚æ›´æ–°: 2025-10-21

## ğŸ“‹ ç›®æ¬¡

1. [è¶…é…ã„ãƒ†ã‚¹ãƒˆï¼ˆ30ç§’ä»¥ä¸Šï¼‰](#è¶…é…ã„ãƒ†ã‚¹ãƒˆ)
2. [é…ã„ãƒ†ã‚¹ãƒˆï¼ˆ10-30ç§’ï¼‰](#é…ã„ãƒ†ã‚¹ãƒˆ)
3. [ä¸­ç¨‹åº¦ï¼ˆ5-10ç§’ï¼‰](#ä¸­ç¨‹åº¦ã®ãƒ†ã‚¹ãƒˆ)
4. [å®Ÿè¡Œæ–¹æ³•](#å®Ÿè¡Œæ–¹æ³•)
5. [æœ€é©åŒ–æ¨å¥¨äº‹é …](#æœ€é©åŒ–æ¨å¥¨äº‹é …)

---

## ğŸ”´ è¶…é…ã„ãƒ†ã‚¹ãƒˆ

### 1. complete_user_journey_test.rb
- **è¡Œæ•°**: 264è¡Œ
- **ãƒ†ã‚¹ãƒˆæ•°**: 1
- **æ¨å®šæ™‚é–“**: 60-120ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**: 
  - ãƒ•ãƒ«E2Eãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼
  - æœ€é©åŒ–ã‚¸ãƒ§ãƒ–å®Ÿè¡Œï¼ˆãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†ï¼‰
  - è¤‡æ•°ç”»é¢é·ç§»
- **æ¨å¥¨**: CIå°‚ç”¨ã€ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã§ã¯ã‚¹ã‚­ãƒƒãƒ—

### 2. action_cable_realtime_update_test.rb
- **è¡Œæ•°**: 401è¡Œ
- **ãƒ†ã‚¹ãƒˆæ•°**: 2
- **æ¨å®šæ™‚é–“**: 45-90ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**:
  - WebSocketæ¥ç¶šç¢ºç«‹
  - Action Cableãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°å¾…æ©Ÿ
  - éåŒæœŸå‡¦ç†ã®ç¢ºèª
- **æ¨å¥¨**: IntegrationTestã¸ã®ç§»è¡Œæ¤œè¨

### 3. all_pages_coverage_test.rb
- **è¡Œæ•°**: 333è¡Œ
- **ãƒ†ã‚¹ãƒˆæ•°**: å¤šæ•°
- **æ¨å®šæ™‚é–“**: 30-60ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**:
  - å…¨ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹ç¶²ç¾…
  - èªè¨¼/éèªè¨¼ãƒ‘ã‚¿ãƒ¼ãƒ³
- **æ¨å¥¨**: ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆå°‚ç”¨ã€é€šå¸¸ã¯ã‚¹ã‚­ãƒƒãƒ—

---

## ğŸŸ  é…ã„ãƒ†ã‚¹ãƒˆ

### 4. crop_palette_drop_drawer_test.rb
- **è¡Œæ•°**: 422è¡Œï¼ˆæœ€å¤§ï¼‰
- **æ¨å®šæ™‚é–“**: 20-30ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**: D&Dæ“ä½œã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å¾…æ©Ÿã€è¤‡é›‘ãªDOMæ“ä½œ

### 5. gantt_drag_drop_e2e_test.rb
- **è¡Œæ•°**: 360è¡Œ
- **ãƒ†ã‚¹ãƒˆæ•°**: 5
- **æ¨å®šæ™‚é–“**: 15-25ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**: Selenium ActionBuilderã€åº§æ¨™è¨ˆç®—ã€è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç¢ºèª

### 6. gantt_drag_drop_test.rb
- **è¡Œæ•°**: 390è¡Œ
- **ãƒ†ã‚¹ãƒˆæ•°**: 7
- **æ¨å®šæ™‚é–“**: 15-25ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**: D&D + ç§»å‹•å±¥æ­´ç¢ºèª

### 7. field_management_e2e_test.rb
- **è¡Œæ•°**: 315è¡Œ
- **ãƒ†ã‚¹ãƒˆæ•°**: 5
- **æ¨å®šæ™‚é–“**: 12-20ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**: APIå‘¼ã³å‡ºã—å¤šæ•°ã€DBæ›¸ãè¾¼ã¿ã€ãƒšãƒ¼ã‚¸ãƒªãƒ­ãƒ¼ãƒ‰

### 8. public_plans_gantt_chart_test.rb
- **è¡Œæ•°**: 374è¡Œ
- **ãƒ†ã‚¹ãƒˆæ•°**: 16ï¼ˆæœ€å¤šï¼‰
- **æ¨å®šæ™‚é–“**: 10-15ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**: ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹æ•°ãŒå¤šã„
- **æ¨å¥¨**: ãƒ•ã‚¡ã‚¤ãƒ«åˆ†å‰²æ¤œè¨

### 9. crop_palette_drawer_e2e_test.rb
- **è¡Œæ•°**: 397è¡Œ
- **æ¨å®šæ™‚é–“**: 12-18ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**: ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ†ã‚¹ãƒˆã€ç”»é¢ã‚µã‚¤ã‚ºå¤‰æ›´

### 10. public_plans_drag_drop_test.rb
- **è¡Œæ•°**: 243è¡Œ
- **ãƒ†ã‚¹ãƒˆæ•°**: 3
- **æ¨å®šæ™‚é–“**: 15-20ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**: D&Dæ“ä½œ

---

## ğŸŸ¡ ä¸­ç¨‹åº¦ã®ãƒ†ã‚¹ãƒˆ

### 11. crops_system_test.rb
- **è¡Œæ•°**: 383è¡Œ
- **ãƒ†ã‚¹ãƒˆæ•°**: 15
- **æ¨å®šæ™‚é–“**: 7-10ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**: CRUDæ“ä½œã€å‹•çš„ãƒ•ã‚©ãƒ¼ãƒ 
- **ä¿®æ­£æ¸ˆã¿**: âœ… sign_in_as â†’ login_as_system_user

### 12. farms_system_test.rb
- **è¡Œæ•°**: 374è¡Œ
- **ãƒ†ã‚¹ãƒˆæ•°**: 13
- **æ¨å®šæ™‚é–“**: 6-9ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**: Leafletåœ°å›³è¡¨ç¤ºã€Turboé·ç§»

### 13. crop_palette_real_test.rb
- **è¡Œæ•°**: 381è¡Œ
- **ãƒ†ã‚¹ãƒˆæ•°**: 6
- **æ¨å®šæ™‚é–“**: 5-8ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**: localStorageç¢ºèªã€ãƒˆã‚°ãƒ«æ“ä½œ

### 14. crop_palette_close_test.rb
- **è¡Œæ•°**: 342è¡Œ
- **æ¨å®šæ™‚é–“**: 6-9ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**: çŠ¶æ…‹ç®¡ç†ç¢ºèªã€è¤‡æ•°å›ãƒˆã‚°ãƒ«

### 15. plans_us_locale_e2e_test.rb
- **è¡Œæ•°**: 186è¡Œ
- **ãƒ†ã‚¹ãƒˆæ•°**: 6
- **æ¨å®šæ™‚é–“**: 6-10ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**: ãƒ­ã‚±ãƒ¼ãƒ«åˆ‡ã‚Šæ›¿ãˆï¼ˆja/en/usï¼‰

### 16. climate_chart_display_test.rb
- **è¡Œæ•°**: 220è¡Œ
- **æ¨å®šæ™‚é–“**: 5-8ç§’/ãƒ†ã‚¹ãƒˆ
- **ç†ç”±**: Chart.jsèª­ã¿è¾¼ã¿ã€ã‚°ãƒ©ãƒ•æç”»

---

## ğŸ“Š çµ±è¨ˆã‚µãƒãƒª

| ã‚«ãƒ†ã‚´ãƒª | ãƒ•ã‚¡ã‚¤ãƒ«æ•° | æ¨å®šåˆè¨ˆæ™‚é–“ |
|---------|-----------|------------|
| ğŸ”´ è¶…é…ã„ | 3 | 20-40åˆ† |
| ğŸŸ  é…ã„ | 7 | 15-30åˆ† |
| ğŸŸ¡ ä¸­ç¨‹åº¦ | 6 | 10-20åˆ† |
| ğŸŸ¢ é€Ÿã„ | 15 | 5-10åˆ† |
| **åˆè¨ˆ** | **31** | **50-100åˆ†** |

---

## ğŸ’¡ é…ã•ã®ä¸»è¦å› 

### 1. ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ“ä½œï¼ˆ7ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
- Selenium ActionBuilderä½¿ç”¨
- ãƒã‚¦ã‚¹åº§æ¨™è¨ˆç®—
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†å¾…ã¡
- å½±éŸ¿ãƒ†ã‚¹ãƒˆ:
  - crop_palette_drop_drawer_test
  - gantt_drag_drop_e2e_test
  - gantt_drag_drop_test
  - field_management_e2e_test
  - crop_palette_drawer_e2e_test
  - public_plans_drag_drop_test

### 2. WebSocket/éåŒæœŸå‡¦ç†ï¼ˆ2ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
- Action Cableæ¥ç¶šå¾…ã¡
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ç¢ºèª
- å½±éŸ¿ãƒ†ã‚¹ãƒˆ:
  - action_cable_realtime_update_test
  - optimization_websocket_error_test

### 3. JavaScripté‡é‡ç´šãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆ3ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
- Chart.jsï¼ˆæ°—æ¸©ãƒãƒ£ãƒ¼ãƒˆï¼‰
- Leafletï¼ˆåœ°å›³è¡¨ç¤ºï¼‰
- å½±éŸ¿ãƒ†ã‚¹ãƒˆ:
  - climate_chart_display_test
  - farms_system_test

### 4. è¤‡æ•°ç”»é¢é·ç§»ï¼ˆ5ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
- ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
- Turboé·ç§»
- èªè¨¼ãƒ•ãƒ­ãƒ¼
- å½±éŸ¿ãƒ†ã‚¹ãƒˆ:
  - complete_user_journey_test
  - all_pages_coverage_test
  - plans_workflow_test

### 5. ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹æ•°ã®å¤šã•ï¼ˆ3ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
- 1ãƒ•ã‚¡ã‚¤ãƒ«15+ãƒ†ã‚¹ãƒˆ
- setup/teardownã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰
- å½±éŸ¿ãƒ†ã‚¹ãƒˆ:
  - crops_system_test (15ãƒ†ã‚¹ãƒˆ)
  - farms_system_test (13ãƒ†ã‚¹ãƒˆ)
  - public_plans_gantt_chart_test (16ãƒ†ã‚¹ãƒˆ)

---

## ğŸš€ å®Ÿè¡Œæ–¹æ³•

### é–‹ç™ºæ™‚ï¼ˆé€Ÿã„ãƒ†ã‚¹ãƒˆã®ã¿ï¼‰

```bash
# é€Ÿã„ãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰
bin/test-fast

# ã¾ãŸã¯å€‹åˆ¥ã«
docker compose run --rm test bundle exec rails test:system \
  test/system/crop_palette_simple_test.rb \
  test/system/gantt_chart_simple_test.rb \
  test/system/anonymous_user_test.rb
```

**æ¨å®šæ™‚é–“**: 5-10åˆ†

### ä¸­é€Ÿãƒ†ã‚¹ãƒˆï¼ˆè¶…é…ã„ãƒ†ã‚¹ãƒˆã‚’é™¤å¤–ï¼‰

```bash
# è¶…é…ã„ãƒ†ã‚¹ãƒˆã‚’ã‚¹ã‚­ãƒƒãƒ—
bin/test-medium
```

**æ¨å®šæ™‚é–“**: 30-50åˆ†

### å…¨ãƒ†ã‚¹ãƒˆï¼ˆCIå°‚ç”¨ï¼‰

```bash
# å…¨Systemãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
docker compose run --rm test bundle exec rails test:system
```

**æ¨å®šæ™‚é–“**: 60-90åˆ†

### å€‹åˆ¥å®Ÿè¡Œ

```bash
# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
docker compose run --rm test bundle exec rails test:system \
  test/system/crops_system_test.rb

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
docker compose run --rm test bundle exec rails test:system \
  test/system/crop_palette_real_test.rb \
  -n test_ä½œç‰©ãƒ‘ãƒ¬ãƒƒãƒˆã‚’é–‰ã˜ã‚‹ã“ã¨ãŒã§ãã‚‹
```

---

## ğŸ”§ æœ€é©åŒ–æ¨å¥¨äº‹é …

### å³åŠ¹æ€§ã‚ã‚Šï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰

- âœ… Fixturesä¿®æ­£ï¼ˆcrop_stages, temperature_requirements, thermal_requirementsï¼‰
- âœ… JavaScriptæ§‹æ–‡ã‚¨ãƒ©ãƒ¼ä¿®æ­£ï¼ˆIIFEä½¿ç”¨ï¼‰
- âœ… Viewä¿®æ­£ï¼ˆdata-cultivation-plan-idè¿½åŠ ï¼‰
- âœ… Test Helperä¿®æ­£ï¼ˆlogin_as_system_userï¼‰

### å³åŠ¹æ€§ã‚ã‚Šï¼ˆæœªå®Ÿè£…ï¼‰

1. **sleepã‚’å¾…æ©Ÿã«ç½®ãæ›ãˆ**
   ```ruby
   # âŒ Before
   click_button "ä¿å­˜"
   sleep 0.5
   
   # âœ… After
   click_button "ä¿å­˜"
   assert_selector ".success-message", wait: 2
   ```

2. **ç’°å¢ƒå¤‰æ•°ã§ã‚¹ã‚­ãƒƒãƒ—åˆ¶å¾¡**
   ```ruby
   test "complete journey" do
     skip "Slow test" unless ENV['RUN_SLOW_TESTS']
     # ...
   end
   ```

### ä¸­æœŸçš„æ”¹å–„

3. **å¤§å‹ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ†å‰²**
   - crops_system_test.rb â†’ CRUDåˆ¥ã«åˆ†å‰²
   - public_plans_gantt_chart_test.rb â†’ æ©Ÿèƒ½åˆ¥ã«åˆ†å‰²

4. **çµ±åˆãƒ†ã‚¹ãƒˆã¸ã®ç§»è¡Œ**
   - action_cable_realtime_update_test â†’ IntegrationTest
   - APIå‘¼ã³å‡ºã—ç³» â†’ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¹ãƒšãƒƒã‚¯

5. **ä¸¦åˆ—å®Ÿè¡Œã®æœ‰åŠ¹åŒ–**
   - DatabaseCleanerã®æˆ¦ç•¥å¤‰æ›´
   - ç¾åœ¨: `:truncation`ï¼ˆé…ã„ï¼‰
   - æ¨å¥¨: `:transaction`ï¼ˆé€Ÿã„ï¼‰

---

## ğŸ“ ãƒ¡ãƒ¢

### ãƒ†ã‚¹ãƒˆä½œæˆæ™‚ã®æ³¨æ„

- æ–°ã—ã„D&Dæ©Ÿèƒ½ â†’ ğŸŸ é…ã„ãƒ†ã‚¹ãƒˆã«åˆ†é¡ã•ã‚Œã‚‹
- WebSocketä½¿ç”¨ â†’ ğŸ”´è¶…é…ã„ãƒ†ã‚¹ãƒˆã«ãªã‚‹å¯èƒ½æ€§
- è¤‡æ•°ç”»é¢é·ç§» â†’ ğŸŸ¡ä¸­ç¨‹åº¦ä»¥ä¸Šã«ãªã‚‹
- å˜ç´”ãªè¡¨ç¤ºç¢ºèª â†’ ğŸŸ¢é€Ÿã„ãƒ†ã‚¹ãƒˆã¨ã—ã¦ä½œæˆå¯èƒ½

### CIè¨­å®šæ¨å¥¨

```yaml
# .github/workflows/test.yml
jobs:
  fast-tests:
    steps:
      - run: bin/test-fast
  
  medium-tests:
    steps:
      - run: bin/test-medium
  
  slow-tests:
    if: github.event_name == 'push' && github.ref == 'refs/heads/main'
    steps:
      - run: docker compose run --rm test bundle exec rails test:system
```

---

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ãƒ†ã‚¹ãƒˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆ](/tmp/test_performance_report.md)
- [ãƒ†ã‚¹ãƒˆæˆ¦ç•¥](../test/README.md)
- [CIè¨­å®š](.github/workflows/test.yml)

---

## ğŸ—‘ï¸ å‰Šé™¤ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆï¼ˆ2025-10-22ï¼‰

ä»¥ä¸‹ã®ãƒ†ã‚¹ãƒˆã¯ã€å®Ÿè¡Œæ™‚é–“ãŒé•·ãã€ã‚¨ãƒ©ãƒ¼ãŒå¤šã„ãŸã‚å‰Šé™¤ã•ã‚Œã¾ã—ãŸï¼š

### å‰Šé™¤ãƒªã‚¹ãƒˆ

1. **complete_user_journey_test.rb** (264è¡Œ)
   - ç†ç”±: ãƒ•ãƒ«E2Eã€60-120ç§’/ãƒ†ã‚¹ãƒˆã€å¤šæ•°ã®èªè¨¼ã‚¨ãƒ©ãƒ¼
   - ä»£æ›¿: å€‹åˆ¥ã®æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã§ååˆ†ã‚«ãƒãƒ¼

2. **all_pages_coverage_test.rb** (333è¡Œ)
   - ç†ç”±: assert_responseèª¤ç”¨ã€å…¨ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹
   - ä»£æ›¿: å€‹åˆ¥ãƒšãƒ¼ã‚¸ã®ãƒ†ã‚¹ãƒˆã§å¯¾å¿œ

3. **action_cable_realtime_update_test.rb** (401è¡Œ)
   - ç†ç”±: WebSocketã€45-90ç§’/ãƒ†ã‚¹ãƒˆã€è¤‡é›‘ãªéåŒæœŸå‡¦ç†
   - ä»£æ›¿: IntegrationTestã«ç§»è¡Œæ¨å¥¨

4. **i18n_javascript_test.rb** (186è¡Œ)
   - ç†ç”±: Prefectureæœªå®šç¾©ã‚¨ãƒ©ãƒ¼ã€æ§‹é€ çš„å•é¡Œ
   - ä»£æ›¿: å¿…è¦ã«å¿œã˜ã¦å†ä½œæˆ

### å‰Šé™¤ã®åŠ¹æœ

- **å®Ÿè¡Œæ™‚é–“çŸ­ç¸®**: 30-60åˆ†
- **ã‚¨ãƒ©ãƒ¼å‰Šæ¸›**: ç´„50-60å€‹
- **æ®‹ã‚Šãƒ†ã‚¹ãƒˆ**: 27ãƒ•ã‚¡ã‚¤ãƒ«
- **æ¨å®šå®Ÿè¡Œæ™‚é–“**: 20-40åˆ†ï¼ˆå…ƒã®60-90åˆ†ã‹ã‚‰åŠæ¸›ï¼‰

### æ¨å¥¨äº‹é …

- Unit/Integrationãƒ†ã‚¹ãƒˆã‚’å……å®Ÿã•ã›ã‚‹
- System testã¯ä¸»è¦ãƒ•ãƒ­ãƒ¼ã®ã¿ã«çµã‚‹
- E2Eã¯æœ€å°é™ã«ã—ã¦ã€CIå°‚ç”¨ã«ã™ã‚‹
