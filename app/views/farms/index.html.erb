<% content_for :title, "#{t('.title')} - AGRR" %>

<div class="page-header">
  <h1 class="page-title"><%= t('.title') %></h1>
  <%= link_to t('.new_farm'), new_farm_path, class: "btn btn-success" %>
</div>

<!-- Debug information (development only) -->
<% if Rails.env.development? %>
  <div class="debug-box">
    <strong><%= t('.debug.label') %></strong>
    admin_user? = <%= admin_user? %>,
    current_user.admin = <%= current_user.admin %>,
    @reference_farms.count = <%= @reference_farms.count %>,
    @farms.count = <%= @farms.count %>
  </div>
<% end %>

<% if @reference_farms.any? %>
  <!-- Reference Farms (admin only) -->
  <div class="mb-6">
    <h2 class="section-header"><%= t('.reference_farms') %> (<%= t('.count', count: @reference_farms.count) %>)</h2>
    
    <div class="farms-grid">
      <% @reference_farms.each do |farm| %>
        <%= render "farm_card_wrapper", farm: farm %>
      <% end %>
    </div>
  </div>
  
  <hr class="section-divider">
  
  <!-- My Farms -->
  <h2 class="section-header"><%= t('.my_farms') %> (<%= t('.count', count: @farms.count) %>)</h2>
<% end %>
    
    <% if @farms.any? %>
      <div class="farms-grid" id="farms">
        <% @farms.each do |farm| %>
          <%= turbo_stream_from farm %>
          <%= render "farm_card_wrapper", farm: farm %>
        <% end %>
      </div>
    <% else %>
      <div class="empty-state">
        <div class="empty-state-icon"><%= t('.empty.icon') %></div>
        <h3><%= t('.empty.title') %></h3>
        <p><%= t('.empty.description') %></p>
        <%= link_to t('.empty.button'), new_farm_path, class: "btn btn-success" %>
      </div>
    <% end %>


