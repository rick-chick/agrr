<% content_for :title, "#{@farm.display_name} - AGRR" %>

<div class="page-header">
  <h1 class="page-title farm-name"><%= @farm.display_name %></h1>
  <div>
    <%= link_to "圃場一覧", farm_fields_path(@farm), class: "btn btn-info" %>
    <%= link_to "編集", edit_farm_path(@farm), class: "btn btn-secondary" %>
  </div>
</div>

<%= turbo_stream_from @farm %>
    
<div class="farm-card">
  <%= render "farm_weather_section", farm: @farm, fields_count: @fields.count %>
      
      <% if @fields.any? %>
        <div class="fields-section">
          <h3>圃場一覧</h3>
          <div class="fields-grid">
            <% @fields.each do |field| %>
              <div class="field-card-small">
                <h4><%= field.display_name %></h4>
                <div class="field-actions">
                  <%= link_to "詳細", farm_field_path(@farm, field), class: "btn btn-small" %>
                  <%= link_to "編集", edit_farm_field_path(@farm, field), class: "btn btn-small btn-secondary" %>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      <% else %>
        <div class="empty-fields">
          <p>まだ圃場が登録されていません。</p>
          <%= link_to "最初の圃場を追加", new_farm_field_path(@farm), class: "btn btn-success" %>
        </div>
      <% end %>
      
      <div class="actions">
        <%= link_to "農場一覧に戻る", farms_path, class: "btn" %>
        <%= link_to "圃場一覧", farm_fields_path(@farm), class: "btn btn-info" %>
        <%= link_to "編集", edit_farm_path(@farm), class: "btn btn-secondary" %>
        <%= button_to "削除", @farm, method: :delete, 
                    class: "btn btn-danger", 
                    confirm: "この農場を削除しますか？" %>
      </div>
    </div>

