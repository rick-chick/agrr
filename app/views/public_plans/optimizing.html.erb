<%# encoding: UTF-8 %>
<div class="public-plans-wrapper pb-0" 
     data-cultivation-plan-id="<%= @cultivation_plan.id %>"
     data-optimization-error-message="<%= t('.error_message') %>">
  <div class="free-plans-container">
    <!-- Compact Header -->
    <div class="compact-header-card">
      <div class="compact-header-title">
        <span class="title-icon">ðŸŒ±</span>
        <span class="title-text"><%= t('public_plans.title') %></span>
        <span class="status-badge optimizing"><%= t('.status_badge') %></span>
      </div>
      <div class="compact-subtitle">
        <%= @cultivation_plan.farm.name %> Â· <%= t('.crops_count', count: @cultivation_plan.field_cultivations.count, default: "%{count}ç¨®é¡žã®ä½œç‰©") %>
      </div>
    </div>
    
    <!-- Main Content: Loading Animation -->
    <div class="content-card">
      
      <div class="optimization-hint">
        <%= t('.hint') %>
      </div>
      
      <!-- Google AdSense åºƒå‘Š -->
      <%= render 'shared/adsense_display_ad', ad_slot: '0000000000', ad_format: 'horizontal' %>
    </div>
    
    <!-- Spacer for fixed progress bar -->
    <div class="spacer-for-fixed-bar"></div>
  </div>
</div>

<!-- Fixed Bottom Progress Bar -->
<div class="fixed-progress-bar">
  <div class="fixed-progress-container">
    <div class="progress-header">
      <div class="progress-label-with-spinner">
        <span class="spinner spinner-sm" id="loading-spinner"></span>
        <div class="progress-info">
          <div class="progress-phase-message" id="phase-message">
            <%= @cultivation_plan.optimization_phase_message || t('.progress.default_message') %>
          </div>
          <div class="progress-duration-hint"><%= t('.progress.duration_hint') %></div>
        </div>
      </div>
      <div class="progress-elapsed-time" 
           id="elapsed-time"
           data-elapsed-time-template="<%= t('.progress.elapsed_time', time: '%{time}') %>"
           data-elapsed-time-minute-template="<%= t('.progress.elapsed_time_minute', minutes: '%{minutes}', seconds: '%{seconds}') %>">
        <%= t('.progress.elapsed_time', time: '0') %>
      </div>
    </div>
  </div>
</div>

<!-- Styles are loaded from app/assets/stylesheets/features/optimizing.css via layout -->
<!-- Auto-reload script is loaded from app/javascript/optimizing.js via application.js -->

