<%# encoding: UTF-8 %>
<div class="public-plans-wrapper optimizing-wrapper">
  <div class="free-plans-container">
    <!-- Compact Header -->
    <div class="compact-header-card">
      <div class="compact-header-title">
        <span class="title-icon">🌱</span>
        <span class="title-text">作付け計画</span>
        <span class="status-badge optimizing">最適化中</span>
      </div>
      <div class="compact-subtitle">
        <%= @cultivation_plan.farm.name %> · <%= @cultivation_plan.field_cultivations.count %>種類の作物
      </div>
    </div>
    
    <!-- Main Content: Advertisement -->
    <div class="content-card">
      <!-- Large Advertisement Space -->
      <div class="optimizing-ad-wrapper">
        <div class="optimizing-ad-label">
          スポンサー広告
        </div>
        <div class="optimizing-ad-content">
          <div class="optimizing-ad-placeholder">
            <div class="optimizing-ad-title">広告スペース</div>
            <div class="optimizing-ad-size">728 x 90</div>
            <p class="optimizing-ad-note">
              Google AdSense や他の広告ネットワークのコードを配置<br>
              収益化のメインエリア
            </p>
          </div>
        </div>
      </div>
      
      <div class="optimizing-info-text">
        💡 最適化が完了すると自動的に結果画面に移動します
      </div>
    </div>
    
    <!-- Spacer for fixed progress bar -->
    <div class="optimizing-spacer"></div>
  </div>
</div>

<!-- Fixed Bottom Progress Bar -->
<div class="fixed-progress-bar">
  <div class="fixed-progress-container">
    <div class="progress-header">
      <div class="progress-header-label">
        最適化状況
      </div>
      <div class="progress-header-count">
        <%= @cultivation_plan.field_cultivations.status_completed.count %> / <%= @cultivation_plan.field_cultivations.count %> 完了
      </div>
    </div>
    
    <!-- Progress Bar -->
    <div class="progress-bar-container">
      <div class="progress-bar-fill" style="width: <%= @cultivation_plan.optimization_progress %>%;"></div>
    </div>
  </div>
</div>

<!-- Styles loaded via layout -->

<!-- Auto-reload Script -->
<script>
  setTimeout(function() {
    window.location.reload();
  }, 3000);
</script>

