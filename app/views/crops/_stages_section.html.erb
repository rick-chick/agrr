<%# app/views/crops/_stages_section.html.erb %>
<%# ä½œç‰©è©³ç´°ç”»é¢ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã‚»ã‚¯ã‚·ãƒ§ãƒ³ %>
<%# 
  ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:
    crop: Crop - è¡¨ç¤ºã™ã‚‹ä½œç‰©ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
  
  å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ä¾‹:
    crop.crop_stages = [
      { 
        name: "ç™ºèŠ½æœŸ", 
        order: 1,
        temperature_requirement: { 
          base_temperature: 10, optimal_min: 20, optimal_max: 30,
          low_stress_threshold: 5, high_stress_threshold: 35,
          frost_threshold: 0, sterility_risk_threshold: 40, max_temperature: 45
        },
        thermal_requirement: { required_gdd: 100 },
        sunshine_requirement: { minimum_sunshine_hours: 6, target_sunshine_hours: 8 },
        nutrient_requirement: { daily_uptake_n: 0.5, daily_uptake_p: 0.2, daily_uptake_k: 0.3 }
      },
      { name: "æˆé•·æœŸ", order: 2, thermal_requirement: { required_gdd: 200 } }
    ]
  
  ä½¿ç”¨ä¾‹ï¼ˆå¤–éƒ¨ã‹ã‚‰ç‹¬ç«‹ã—ã¦ä½¿ç”¨å¯èƒ½ï¼‰:
    <%= render 'crops/stages_section', crop: Crop.find(1) %>
    <%= render 'crops/stages_section', crop: @custom_crop_with_stages %>
%>

<div class="stages-section">
  <h2 class="stages-title"><%= t('crops.show.stages_title') %></h2>
  <% if crop.crop_stages.any? %>
    <ol class="stages-list">
      <% crop.crop_stages.order(:order).each do |stage| %>
        <li class="stage-item">
          <div class="stage-name"><%= stage.name %></div>
          <div class="stage-order"><%= t('crops.show.stage_order') %>: <%= stage.order %></div>
          
          <% if stage.temperature_requirement || stage.thermal_requirement || stage.sunshine_requirement || stage.nutrient_requirement %>
            <div class="stage-requirements">
              <% if stage.temperature_requirement %>
                <div class="requirement-item">
                  <div class="requirement-label">ğŸŒ¡ï¸ <%= t('crops.show.temperature_requirement') %></div>
                  <div class="requirement-value">
                    <%= t('crops.show.base_temperature') %>: <%= stage.temperature_requirement.base_temperature %>Â°C<br>
                    <%= t('crops.show.optimal_temperature') %>: <%= stage.temperature_requirement.optimal_min %>ã€œ<%= stage.temperature_requirement.optimal_max %>Â°C<br>
                    <%= t('crops.show.low_stress_threshold') %>: <%= stage.temperature_requirement.low_stress_threshold %>Â°C<br>
                    <%= t('crops.show.high_stress_threshold') %>: <%= stage.temperature_requirement.high_stress_threshold %>Â°C<br>
                    <%= t('crops.show.frost_threshold') %>: <%= stage.temperature_requirement.frost_threshold %>Â°C<br>
                    <%= t('crops.show.sterility_risk_threshold') %>: <%= stage.temperature_requirement.sterility_risk_threshold %>Â°C<br>
                    <%= t('crops.show.max_temperature') %>: <%= stage.temperature_requirement.max_temperature %>Â°C
                  </div>
                </div>
              <% end %>
              
              <% if stage.thermal_requirement %>
                <div class="requirement-item">
                  <div class="requirement-label">ğŸŒ¡ï¸ <%= t('crops.show.thermal_requirement') %></div>
                  <div class="requirement-value">
                    <%= t('crops.show.required_gdd') %>: <%= stage.thermal_requirement.required_gdd %>Â°Cãƒ»æ—¥
                  </div>
                </div>
              <% end %>
              
              <% if stage.sunshine_requirement %>
                <div class="requirement-item">
                  <div class="requirement-label">â˜€ï¸ <%= t('crops.show.sunshine_requirement') %></div>
                  <div class="requirement-value">
                    <%= t('crops.show.minimum_sunshine_hours') %>: <%= stage.sunshine_requirement.minimum_sunshine_hours %>æ™‚é–“<br>
                    <%= t('crops.show.target_sunshine_hours') %>: <%= stage.sunshine_requirement.target_sunshine_hours %>æ™‚é–“
                  </div>
                </div>
              <% end %>
              
              <% if stage.nutrient_requirement %>
                <div class="requirement-item">
                  <div class="requirement-label">ğŸŒ± <%= t('crops.show.nutrient_requirement') %></div>
                  <div class="requirement-value">
                    <%= t('crops.show.daily_uptake_n') %>: <%= stage.nutrient_requirement.daily_uptake_n %> g/mÂ²/day<br>
                    <%= t('crops.show.daily_uptake_p') %>: <%= stage.nutrient_requirement.daily_uptake_p %> g/mÂ²/day<br>
                    <%= t('crops.show.daily_uptake_k') %>: <%= stage.nutrient_requirement.daily_uptake_k %> g/mÂ²/day
                  </div>
                </div>
              <% end %>
              
            </div>
          <% end %>
        </li>
      <% end %>
    </ol>
  <% else %>
    <div class="no-stages">
      <div class="empty-state-icon">ğŸŒ±</div>
      <h3><%= t('crops.show.no_stages_title') %></h3>
      <p><%= t('crops.show.no_stages_description') %></p>
    </div>
  <% end %>
</div>

