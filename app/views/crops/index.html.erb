<% content_for :title, "作物一覧 - AGRR" %>

<div class="page-header">
  <h1 class="page-title">作物一覧</h1>
  <%= link_to "新しい作物を追加", new_crop_path, class: "btn btn-success" %>
</div>

<% if @crops.any? %>
  <div class="crops-grid">
    <% @crops.each do |crop| %>
      <div class="crop-card">
        <h3 class="crop-name"><%= crop.name %></h3>
        <% if crop.variety.present? %>
          <div class="crop-variety">品種: <%= crop.variety %></div>
        <% end %>
        <div class="crop-type <%= crop.is_reference ? 'reference' : 'user' %>">
          <%= crop.is_reference ? '参照作物' : 'ユーザ作物' %>
        </div>
        <div class="crop-actions">
          <%= link_to "詳細", crop_path(crop), class: "btn btn-small" %>
          <% if crop.is_reference %>
            <%# 参照作物は管理者のみ編集・削除可能 %>
            <% if admin_user? %>
              <%= link_to "編集", edit_crop_path(crop), class: "btn btn-small btn-secondary" %>
              <%= button_to "削除", crop_path(crop), method: :delete, 
                          class: "btn btn-small btn-danger", 
                          confirm: "この作物を削除しますか？" %>
            <% end %>
          <% else %>
            <%# ユーザー作物は所有者のみ編集・削除可能 %>
            <%= link_to "編集", edit_crop_path(crop), class: "btn btn-small btn-secondary" %>
            <%= button_to "削除", crop_path(crop), method: :delete, 
                        class: "btn btn-small btn-danger", 
                        confirm: "この作物を削除しますか？" %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <div class="empty-state">
    <div class="empty-state-icon">🌾</div>
    <h3>まだ作物が登録されていません</h3>
    <p>最初の作物を追加して始めましょう。</p>
    <%= link_to "作物を追加", new_crop_path, class: "btn btn-success" %>
  </div>
<% end %>
