<% content_for :title, "#{t('.title')} - AGRR" %>

<div class="page-header">
  <h1 class="page-title"><%= t('.title') %></h1>
  <%= link_to t('.new_crop'), new_crop_path, class: "btn btn-success" %>
</div>

<% if @crops.any? %>
  <div class="crops-grid">
    <% @crops.each do |crop| %>
      <div class="crop-card" id="<%= dom_id(crop) %>" data-undo-delete-record>
          <h3 class="crop-name"><%= crop.name %></h3>
          <% if crop.variety.present? %>
            <div class="crop-variety"><%= t('activerecord.attributes.crop.variety') %>: <%= crop.variety %></div>
          <% end %>
          <% if admin_user? && crop.is_reference %>
            <div class="crop-type reference"><%= t('.reference_crops') %></div>
          <% end %>
          <div class="crop-actions">
            <%= link_to t('.actions.show'), crop_path(crop), class: "btn btn-info btn-sm" %>
            <% if crop.is_reference %>
              <%# Reference crops: admin only %>
              <% if admin_user? %>
                <%= link_to t('.actions.edit'), edit_crop_path(crop), class: "btn btn-secondary btn-sm" %>
                <%= link_to t('.actions.delete'), crop_path(crop),
                            class: "btn btn-error btn-sm",
                            data: {
                              controller: "undo-delete",
                              action: "click->undo-delete#submit",
                              turbo_method: :delete,
                              undo_delete_url_value: crop_path(crop),
                              undo_delete_message_value: t('crops.undo.toast', name: crop.name)
                            } %>
              <% end %>
            <% else %>
              <%# User crops: owner only %>
              <%= link_to t('.actions.edit'), edit_crop_path(crop), class: "btn btn-secondary btn-sm" %>
              <%= link_to t('.actions.delete'), crop_path(crop),
                          class: "btn btn-error btn-sm",
                          data: {
                            controller: "undo-delete",
                            action: "click->undo-delete#submit",
                            turbo_method: :delete,
                            undo_delete_url_value: crop_path(crop),
                            undo_delete_message_value: t('crops.undo.toast', name: crop.name)
                          } %>
            <% end %>
          </div>
        </div>
    <% end %>
  </div>
<% else %>
  <div class="empty-state">
    <div class="empty-state-icon"><%= t('.empty.icon') %></div>
    <h3><%= t('.empty.title') %></h3>
    <p><%= t('.empty.description') %></p>
    <%= link_to t('.empty.button'), new_crop_path, class: "btn btn-success" %>
  </div>
<% end %>
