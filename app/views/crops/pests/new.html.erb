<% content_for :title, "#{@crop.name} - #{t('.title')} - AGRR" %>

<div class="page-header">
  <h1 class="page-title">
    <%= link_to @crop.name, crop_path(@crop), class: "crop-link" %> - <%= t('.title') %>
  </h1>
  <%= link_to t('.back_to_list'), crop_pests_path(@crop), class: "btn btn-secondary" %>
</div>

<div class="form-section">
  <h2 class="form-section-title"><%= t('.associate_existing_pest') %></h2>
  <% if @unassociated_pests.any? %>
    <%= form_with url: crop_pests_path(@crop), method: :post, local: true do |f| %>
      <div class="form-group">
        <%= f.label :pest_id, t('.select_existing_pest'), class: 'form-label' %>
        <%= f.select :pest_id, 
            options_from_collection_for_select(@unassociated_pests, :id, :name),
            { include_blank: t('.select_pest_placeholder') },
            { class: 'form-control' } %>
      </div>
      <%= f.submit t('.associate_button'), class: 'btn btn-success' %>
    <% end %>
  <% else %>
    <p><%= t('.no_unassociated_pests') %></p>
  <% end %>
</div>

<div class="form-section">
  <h2 class="form-section-title"><%= t('.create_new_pest') %></h2>
  <%= render 'form', pest: @pest, crop: @crop %>
</div>

<%= link_to t('.back_to_list'), crop_pests_path(@crop), class: "btn btn-secondary" %>

