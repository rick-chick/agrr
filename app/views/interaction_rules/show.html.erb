<% content_for :title, "#{t('.title')} - AGRR" %>

<div class="page-header">
  <h1 class="page-title"><%= t('.title') %></h1>
  <div>
    <% if @interaction_rule.is_reference %>
      <% if admin_user? %>
        <%= link_to t('.edit'), edit_interaction_rule_path(@interaction_rule), class: "btn btn-secondary" %>
      <% end %>
    <% else %>
      <%= link_to t('.edit'), edit_interaction_rule_path(@interaction_rule), class: "btn btn-secondary" %>
      <%= link_to t('.delete'), interaction_rule_path(@interaction_rule), 
                  class: "btn btn-error", 
                  data: { 
                    turbo_method: :delete,
                    turbo_confirm: t('.confirm_delete')
                  } %>
    <% end %>
    <%= link_to t('.back_to_list'), interaction_rules_path, class: "btn btn-ghost" %>
  </div>
</div>

<div class="rule-detail-card">
  <% if admin_user? && @interaction_rule.is_reference %>
    <div class="mb-4">
      <span class="badge badge-info"><%= t('.system_rule_badge') %></span>
    </div>
  <% end %>
  
  <div class="detail-row">
    <div class="detail-label"><%= t('.rule_type') %></div>
    <div class="detail-value"><%= @interaction_rule.rule_type %></div>
  </div>

  <div class="detail-row">
    <div class="detail-label"><%= t('.source_group') %></div>
    <div class="detail-value"><%= @interaction_rule.source_group %></div>
  </div>

  <div class="detail-row">
    <div class="detail-label"><%= t('.target_group') %></div>
    <div class="detail-value"><%= @interaction_rule.target_group %></div>
  </div>

  <div class="detail-row">
    <div class="detail-label"><%= t('.impact_ratio') %></div>
    <div class="detail-value">
      <%= @interaction_rule.impact_ratio %>
      <span class="text-muted">
        <% if @interaction_rule.impact_ratio < 1 %>
          (<%= t('.decrease', percent: ((1 - @interaction_rule.impact_ratio) * 100).round) %>)
        <% elsif @interaction_rule.impact_ratio > 1 %>
          (<%= t('.increase', percent: ((@interaction_rule.impact_ratio - 1) * 100).round) %>)
        <% else %>
          (<%= t('.no_impact') %>)
        <% end %>
      </span>
    </div>
  </div>

  <div class="detail-row">
    <div class="detail-label"><%= t('.direction') %></div>
    <div class="detail-value">
      <%= @interaction_rule.is_directional ? t('.directional') : t('.bidirectional') %>
    </div>
  </div>

  <% if @interaction_rule.description.present? %>
    <div class="detail-row">
      <div class="detail-label"><%= t('.description') %></div>
      <div class="detail-value"><%= @interaction_rule.description %></div>
    </div>
  <% end %>

  <div class="detail-row">
    <div class="detail-label"><%= t('.created_at') %></div>
    <div class="detail-value"><%= l(@interaction_rule.created_at, format: :long) %></div>
  </div>

  <div class="detail-row">
    <div class="detail-label"><%= t('.updated_at') %></div>
    <div class="detail-value"><%= l(@interaction_rule.updated_at, format: :long) %></div>
  </div>
</div>
